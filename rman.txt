
=============================================================  ‡¶Ø‡¶æ ‡¶ï‡¶∞‡¶æ ‡¶Ø‡¶æ‡¶¨‡ßá ‡¶®‡¶æ  ============================================================= 

	‡¶∏‡¶æ‡¶ß‡¶æ‡¶∞‡¶£‡¶§ ‡ß©‡¶ü‡¶æ ‡¶ï‡¶æ‡¶∞‡¶£‡ßá ‡¶π‡ßü:

	1) FRA ‡¶•‡ßá‡¶ï‡ßá archive log manual delete ‡¶ï‡¶∞‡¶æ ‡¶Ø‡¶æ‡¶¨‡ßá ‡¶®‡¶æ
	2) rm -rf ‡¶¶‡¶ø‡ßü‡ßá delete ‡¶ï‡¶∞‡¶≤‡ßá control file ‡¶ú‡¶æ‡¶®‡ßá ‡¶®‡¶æ ‡¶Ø‡ßá ‡¶´‡¶æ‡¶á‡¶≤ ‡¶®‡¶æ‡¶á
	3) FRA auto clean ‡¶ï‡¶∞‡ßá‡¶õ‡ßá ‡¶ï‡¶ø‡¶®‡ßç‡¶§‡ßÅ metadata mismatch ‡¶π‡ßü‡ßá‡¶õ‡ßá

	*** Control file ‡¶è archive log record ‡¶Ü‡¶õ‡ßá, ‡¶ï‡¶ø‡¶®‡ßç‡¶§‡ßÅ physical file ‡¶®‡¶æ‡¶á‡•§ 

	‚úÖ ‡¶è‡¶ñ‡¶® ‡¶ï‡ßÄ ‡¶ï‡¶∞‡¶¨‡ßá? (Production Safe Solution)

	RMAN> crosscheck archivelog all;  ---> ‡¶è‡¶ü‡¶æ RMAN ‡¶ï‡ßá ‡¶¨‡¶≤‡¶¨‡ßá: ‚Äú‡¶Ø‡¶æ ‡¶Ø‡¶æ archive log ‡¶Ü‡¶õ‡ßá ‡¶¨‡¶≤‡ßá ‡¶ú‡¶æ‡¶®‡ßã, OS ‡¶è ‡¶ó‡¶ø‡ßü‡ßá ‡¶ö‡ßá‡¶ï ‡¶ï‡¶∞‡ßã‚Äù

	RMAN> delete expired archivelog all;  --->  ‡¶è‡¶§‡ßá control file ‡¶•‡ßá‡¶ï‡ßá  missing log ‡¶ó‡ßÅ‡¶≤‡ßã‡¶∞ reference remove ‡¶π‡¶¨‡ßá‡•§

	RMAN> Exit    |      rman target /
	
	RMAN> backup database plus archivelog;


    ‚ö†Ô∏è ‡¶§‡ßÅ‡¶Æ‡¶ø ‡¶ï‡¶ø manual ‡¶≠‡¶æ‡¶¨‡ßá FRA ‡¶•‡ßá‡¶ï‡ßá archive log delete ‡¶ï‡¶∞‡ßá‡¶õ‡ßã? ‡¶Ø‡¶¶‡¶ø ‡¶ï‡¶∞‡ßá ‡¶•‡¶æ‡¶ï‡ßã ‚Äî future ‡¶è ‡¶ï‡¶ñ‡¶®‡ßã rm ‡¶¶‡¶ø‡ßü‡ßá archive delete ‡¶ï‡¶∞‡¶¨‡ßá ‡¶®‡¶æ ‚ùå ‡¶∏‡¶¨‡¶∏‡¶Æ‡ßü RMAN ‡¶¶‡¶ø‡ßü‡ßá:

	delete archivelog all completed before 'sysdate-1';	




=============================================================  ‡¶¨‡ßç‡¶Ø‡¶æ‡¶ï‡¶Ü‡¶™ ‡¶®‡¶ø‡¶§‡ßá ‡¶Ø‡¶æ ‡¶Ø‡¶æ ‡¶ï‡¶∞‡¶æ ‡¶≤‡¶æ‡¶ó‡¶¨‡ßá?  ============================================================= 


	‡¶ñ‡ßÅ‡¶¨ ‡¶≠‡¶æ‡¶≤‡ßã ‡¶ö‡¶ø‡¶®‡ßç‡¶§‡¶æ ‡¶ï‡¶∞‡¶õ‡ßã üëç Production safe ‡¶∞‡¶æ‡¶ñ‡¶§‡ßá ‡¶π‡¶≤‡ßá ‡¶∂‡ßÅ‡¶ß‡ßÅ backup ‡¶®‡ßá‡¶ì‡ßü‡¶æ ‡¶®‡¶æ ‚Äî ‡¶†‡¶ø‡¶ï‡¶≠‡¶æ‡¶¨‡ßá ‡¶∏‡¶æ‡¶ú‡¶ø‡ßü‡ßá ‡¶∞‡¶æ‡¶ñ‡¶æ, retain ‡¶ï‡¶∞‡¶æ, ‡¶Ü‡¶∞ test ‡¶ï‡¶∞‡¶æ equally ‡¶ó‡ßÅ‡¶∞‡ßÅ‡¶§‡ßç‡¶¨‡¶™‡ßÇ‡¶∞‡ßç‡¶£‡•§

	‡¶§‡ßÅ‡¶Æ‡¶ø ‡¶è‡¶ñ‡¶® /u01/rman_backup ‡¶è Level 0 ‡¶®‡¶ø‡¶ö‡ßç‡¶õ‡ßã‡•§ ‡¶è‡¶ü‡¶æ ‡¶ï‡¶æ‡¶ú ‡¶ï‡¶∞‡¶¨‡ßá, ‡¶ï‡¶ø‡¶®‡ßç‡¶§‡ßÅ best practice ‡¶è‡¶ï‡¶ü‡ßÅ structured ‡¶π‡¶ì‡ßü‡¶æ ‡¶â‡¶ö‡¶ø‡¶§‡•§

	‡¶∏‡¶æ‡¶ß‡¶æ‡¶∞‡¶£‡¶≠‡¶æ‡¶¨‡ßá production ‡¶è ‡¶è‡¶≠‡¶æ‡¶¨‡ßá ‡¶∞‡¶æ‡¶ñ‡¶æ ‡¶π‡ßü:

	üîµ Weekly Level 0 (Full)
	üü¢ Daily Level 1 (Incremental)
	üü° Frequent Archivelog Backup (‡¶™‡ßç‡¶∞‡¶§‡¶ø ‡ßß‚Äì‡ß® ‡¶ò‡¶®‡ßç‡¶ü‡¶æ)


	Example Schedule:

	Day             Backup
	-------         ---------	        
	Sunday	        Level 0
	Mon‚ÄìSat	        Level 1
	Every 1‚Äì2 hr	Archivelog



	üìÅ Folder Structure ‚Äì Best Practice

	Recommended structure:

	/u01/rman_backup/
		‚îú‚îÄ‚îÄ L0/
		‚îú‚îÄ‚îÄ L1/
		‚îú‚îÄ‚îÄ ARCH/
		‚îî‚îÄ‚îÄ CONTROLFILE/


	‚úÖ Level 0 Script (Weekly)
	RUN {
	ALLOCATE CHANNEL ch1 DEVICE TYPE DISK;

	BACKUP INCREMENTAL LEVEL 0 DATABASE
	FORMAT '/u01/rman_backup/L0/L0_db_%d_%T_%U.bkp';

	BACKUP ARCHIVELOG ALL
	FORMAT '/u01/rman_backup/ARCH/L0_arch_%d_%T_%U.bkp'
	DELETE INPUT;

	BACKUP CURRENT CONTROLFILE
	FORMAT '/u01/rman_backup/CONTROLFILE/ctl_%d_%T_%U.bkp';

	RELEASE CHANNEL ch1;
	}


	‚úÖ Level 1 Script (Daily)
	RUN {
	ALLOCATE CHANNEL ch1 DEVICE TYPE DISK;

	BACKUP INCREMENTAL LEVEL 1 DATABASE
	FORMAT '/u01/rman_backup/L1/L1_db_%d_%T_%U.bkp';

	BACKUP ARCHIVELOG ALL
	FORMAT '/u01/rman_backup/ARCH/L1_arch_%d_%T_%U.bkp'
	DELETE INPUT;

	RELEASE CHANNEL ch1;
	}


	üî• Important Configuration (Must Do in Production)

	1Ô∏è. Retention Policy Set ‡¶ï‡¶∞‡ßã
	CONFIGURE RETENTION POLICY TO RECOVERY WINDOW OF 7 DAYS;  ---> ‡¶Æ‡¶æ‡¶®‡ßá ‡ß≠ ‡¶¶‡¶ø‡¶®‡ßá‡¶∞ ‡¶Ü‡¶ó‡ßá‡¶∞ obsolete backup delete ‡¶ï‡¶∞‡¶æ ‡¶Ø‡¶æ‡¶¨‡ßá‡•§

	2Ô∏è. Controlfile Autobackup ON ‡¶ï‡¶∞‡ßã:
	RMAN> CONFIGURE CONTROLFILE AUTOBACKUP ON;     --->  ‡¶è‡¶ü‡¶æ ‡¶®‡¶æ ‡¶ï‡¶∞‡¶≤‡ßá ‡¶¨‡¶ø‡¶™‡¶¶ ‡¶π‡¶¨‡ßá‡•§

	3Ô∏è. Backup Optimization ON ‡¶ï‡¶∞‡ßã: 
	RMAN> CONFIGURE BACKUP OPTIMIZATION ON;
	
	üîπ BACKUP OPTIMIZATION ON ‡¶ï‡¶∞‡¶≤‡ßá ‡¶≤‡¶æ‡¶≠ ‡¶ï‡ßÄ?

		‡¶ß‡¶∞‡ßã: ‡¶è‡¶ï‡¶á archivelog ‡¶Ü‡¶ó‡ßá backup ‡¶π‡ßü‡ßá‡¶õ‡ßá Data Guard standby ‡¶§‡ßá already shipped ‡¶π‡ßü‡ßá‡¶õ‡ßá

		‡¶§‡¶ñ‡¶® optimization ON ‡¶•‡¶æ‡¶ï‡¶≤‡ßá RMAN:

		‚úî Already backed up file ‡¶Ü‡¶¨‡¶æ‡¶∞ backup ‡¶ï‡¶∞‡¶¨‡ßá ‡¶®‡¶æ
		‚úî Time ‡¶¨‡¶æ‡¶Å‡¶ö‡¶æ‡¶¨‡ßá
		‚úî Disk space ‡¶¨‡¶æ‡¶Å‡¶ö‡¶æ‡¶¨‡ßá

		Production ‡¶è ‡¶è‡¶ü‡¶æ ON ‡¶∞‡¶æ‡¶ñ‡¶æ ‡¶â‡¶ö‡¶ø‡¶§‡•§

	üéØ CONFIGURE RETENTION POLICY TO RECOVERY WINDOW OF 7 DAYS;

		‡¶è‡¶∞ ‡¶Æ‡¶æ‡¶®‡ßá ‡¶ï‡ßÄ?
		üëâ RMAN ‡¶®‡¶ø‡¶∂‡ßç‡¶ö‡¶ø‡¶§ ‡¶ï‡¶∞‡¶¨‡ßá ‡¶Ø‡ßá ‡¶§‡ßÅ‡¶Æ‡¶ø ‡¶ó‡¶§ ‡ß≠ ‡¶¶‡¶ø‡¶®‡ßá‡¶∞ ‡¶Ø‡ßá‡¶ï‡ßã‡¶®‡ßã ‡¶¶‡¶ø‡¶® ‡¶™‡¶∞‡ßç‡¶Ø‡¶®‡ßç‡¶§ database recover ‡¶ï‡¶∞‡¶§‡ßá ‡¶™‡¶æ‡¶∞‡¶¨‡ßá‡•§
		‡¶è‡¶ü‡¶æ ‡¶∏‡¶∞‡¶æ‡¶∏‡¶∞‡¶ø ‚Äú‡ß≠ ‡¶¶‡¶ø‡¶®‡ßá‡¶∞ ‡¶™‡ßÅ‡¶∞‡¶æ‡¶®‡ßã backup delete‚Äù ‡¶ï‡¶∞‡ßá ‡¶®‡¶æ‡•§


	üö® Production Safety Checklist

	‚úî FRA size monitor ‡¶ï‡¶∞‡ßã
	‚úî Backup location ‡¶Ü‡¶≤‡¶æ‡¶¶‡¶æ disk ‡¶è ‡¶∞‡¶æ‡¶ñ‡ßã (database disk ‡¶è ‡¶®‡¶æ ‡¶∞‡¶æ‡¶ñ‡¶æ‡¶á ‡¶≠‡¶æ‡¶≤‡ßã)
	‚úî Monthly restore test ‡¶ï‡¶∞‡ßã
	‚úî crosscheck cron ‡¶è ‡¶∞‡¶æ‡¶ñ‡ßã
	‚úî OS level delete ‡¶ï‡¶ñ‡¶®‡ßã ‡¶ï‡¶∞‡ßã ‡¶®‡¶æ

	üß† Enterprise Level Best Practice

			Minimum ‡¶ï‡¶∞‡ßã:

			Weekly L0
			Daily L1
			Hourly archivelog
			7‚Äì14 days retention
			Separate disk mount (‡¶Ø‡¶¶‡¶ø ‡¶∏‡¶Æ‡ßç‡¶≠‡¶¨ ‡¶π‡ßü)


========================================================================================================================================



	‚úÖ Step-1: ‡ßß ‡¶ò‡¶£‡ßç‡¶ü‡¶æ ‡¶™‡¶∞‡¶™‡¶∞ Archivelog Backup ‡¶ï‡ßÄ‡¶≠‡¶æ‡¶¨‡ßá ‡¶®‡ßá‡¶¨‡ßá?

		‡¶è‡¶ü‡¶æ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø cron job ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞ ‡¶ï‡¶∞‡¶æ‡¶á standard practice (Linux server ‡¶è)‡•§

	üîπ ‡ßß. Archivelog Backup Script ‡¶¨‡¶æ‡¶®‡¶æ‡¶ì

		‡¶ß‡¶∞‡¶æ ‡¶Ø‡¶æ‡¶ï script ‡¶®‡¶æ‡¶Æ: /home/oracle/arch_backup.sh

		#!/bin/bash

		export ORACLE_SID=KNIT_HRMS
		export ORACLE_HOME=/u01/app/oracle/product/19c/dbhome_1
		export PATH=$ORACLE_HOME/bin:$PATH

		rman target / <<EOF

		RUN {
			ALLOCATE CHANNEL ch1 DEVICE TYPE DISK;

			BACKUP
			ARCHIVELOG ALL
			NOT BACKED UP 1 TIMES
			FORMAT '/u01/rman_backup/ARCH/arch_%d_%s_%U.bkp';

			RELEASE CHANNEL ch1;
		}


		EXIT;
		EOF

		*** RMAN> CONFIGURE BACKUP OPTIMIZATION ON; ‡¶ú‡ßá‡¶π‡ßá‡¶§‡ßÅ OPTIMIZATION ON ‡¶§‡¶æ‡¶á DELETE INPUT; ‡¶ï‡¶∞‡¶æ ‡¶≤‡¶æ‡¶ó‡¶¨‡ßá ‡¶®‡¶æ‡•§ ‡¶è‡¶ï‡¶á ‡¶≤‡¶ó ‡¶¶‡ßç‡¶¨‡¶ø‡¶§‡ßÄ‡ßü ‡¶¨‡¶æ‡¶∞ ‡¶¨‡ßç‡¶Ø‡¶æ‡¶ï

		*** jodi dekhte chai kon backup ay kon sequence theke kon sequence porjonto ase 
		
		*** ‡¶Ü‡¶∞‡¶Æ‡ßá‡¶® ‡¶•‡ßá‡¶ï‡ßá ‡¶ï‡¶ø ‡¶ï‡¶ø ‡¶¨‡ßç‡¶Ø‡¶æ‡¶ï‡¶Ü‡¶™ ‡¶®‡ßá‡¶ì‡ßü‡¶æ ‡¶π‡ßü‡ßá‡¶õ‡ßá ‡¶∏‡ßá‡¶ó‡ßÅ‡¶≤‡ßã ‡¶¶‡ßá‡¶ñ‡¶¨‡ßã =  LIST BACKUP OF ARCHIVELOG ALL;
		
		*** policy add korte hobe --> archive log backup na hole delete kora jabe na fra theke.

		Permission ‡¶¶‡¶æ‡¶ì:

		chmod +x /home/oracle/arch_backup.sh

	üîπ ‡ß®. Cron ‡¶è ‡¶∏‡ßá‡¶ü ‡¶ï‡¶∞‡ßã (‡¶™‡ßç‡¶∞‡¶§‡¶ø ‡ßß ‡¶ò‡¶£‡ßç‡¶ü‡¶æ)
		crontab -e


	‡¶è‡¶ü‡¶æ ‡¶Ø‡ßã‡¶ó ‡¶ï‡¶∞‡ßã:

		0 * * * * /home/oracle/arch_backup.sh >> /home/oracle/arch_backup.log 2>&1


	‡¶Æ‡¶æ‡¶®‡ßá: ‡¶™‡ßç‡¶∞‡¶§‡¶ø ‡¶ò‡¶£‡ßç‡¶ü‡¶æ‡¶∞ ‡ß¶ ‡¶Æ‡¶ø‡¶®‡¶ø‡¶ü‡ßá run ‡¶π‡¶¨‡ßá‡•§

		‚úî ‡¶è‡¶ü‡¶æ‡¶á production standard way‡•§

	
	
	
	‚úÖ Step-2: CONFIGURE command ‡¶ï‡ßã‡¶•‡¶æ ‡¶•‡ßá‡¶ï‡ßá ‡¶¶‡¶ø‡¶¨‡ßá?

		‡¶è‡¶á command ‡¶ó‡ßÅ‡¶≤‡ßã SQL*Plus ‡¶•‡ßá‡¶ï‡ßá ‡¶®‡¶æ ‚ùå
		RMAN ‡¶•‡ßá‡¶ï‡ßá ‡¶¶‡¶ø‡¶§‡ßá ‡¶π‡¶¨‡ßá ‚úî

		‡¶è‡¶≠‡¶æ‡¶¨‡ßá:

		rman target /

		‡¶§‡¶æ‡¶∞‡¶™‡¶∞:
		CONFIGURE CONTROLFILE AUTOBACKUP ON;
		CONFIGURE BACKUP OPTIMIZATION ON;

	üîπ CONTROLFILE backup /CONTROLFILE/ folder ‡¶è ‡¶ï‡ßÄ‡¶≠‡¶æ‡¶¨‡ßá ‡¶Ø‡¶æ‡¶¨‡ßá?
	
		Default ‡¶è ‡¶è‡¶ü‡¶æ FRA ‡¶§‡ßá ‡¶Ø‡¶æ‡ßü‡•§
		‡¶§‡ßÅ‡¶Æ‡¶ø ‡¶ö‡¶æ‡¶á‡¶≤‡ßá location configure ‡¶ï‡¶∞‡¶§‡ßá ‡¶™‡¶æ‡¶∞‡ßã:

		CONFIGURE CONTROLFILE AUTOBACKUP FORMAT FOR DEVICE TYPE DISK
		TO '/u01/rman_backup/CONTROLFILE/ctl_%d_%T_%F.bkp';


		‡¶è‡¶ñ‡¶® ‡¶•‡ßá‡¶ï‡ßá controlfile auto backup ‡¶ì‡¶á folder ‡¶è ‡¶Ø‡¶æ‡¶¨‡ßá‡•§

	

	üü¢ 3 Copies of Data

		‡¶§‡ßã‡¶Æ‡¶æ‡¶∞ data ‡¶è‡¶∞ ‡ß©‡¶ü‡¶æ copy ‡¶•‡¶æ‡¶ï‡¶§‡ßá ‡¶π‡¶¨‡ßá:

		Live database

		Local backup

		Offsite backup

	üü¢ 2Ô∏è Different Media

		Backup ‡¶¶‡ßÅ‡¶á ‡¶ß‡¶∞‡¶®‡ßá‡¶∞ storage ‡¶è ‡¶∞‡¶æ‡¶ñ‡¶§‡ßá ‡¶π‡¶¨‡ßá:

		Disk

		NFS / Tape / Cloud

		‡¶ï‡¶æ‡¶∞‡¶£ ‡¶è‡¶ï‡¶á disk crash ‡¶ï‡¶∞‡¶≤‡ßá ‡¶∏‡¶¨ ‡¶∂‡ßá‡¶∑ ‡¶π‡ßü‡ßá ‡¶Ø‡¶æ‡¶¨‡ßá‡•§

	üü¢ 3Ô∏è Offsite Copy

		‡¶è‡¶ï‡¶ü‡¶æ copy ‡¶Ö‡¶®‡ßç‡¶Ø location ‡¶è ‡¶•‡¶æ‡¶ï‡¶§‡ßá ‡¶π‡¶¨‡ßá‡•§

		Example:

		Primary server Dhaka

		Backup copy Tangail / Cloud

		‡¶Ø‡¶¶‡¶ø ‡¶™‡ßÅ‡¶∞‡ßã data center ‡¶Ü‡¶ó‡ßÅ‡¶®‡ßá ‡¶™‡ßÅ‡ßú‡ßá ‡¶Ø‡¶æ‡ßü ‚Äî ‡¶§‡¶¨‡ßÅ‡¶ì data ‡¶•‡¶æ‡¶ï‡¶¨‡ßá‡•§

	üî• Enterprise Setup Example
	
	Copy	                Location
   ------                  -----------
	Live DB	                Local Disk
	Backup 1	            Local Backup Disk
	Backup 2	            NFS Server
	Backup 3	            AWS S3 / Tape
	
	üéØ ‡¶§‡ßã‡¶Æ‡¶æ‡¶∞ ‡¶¨‡¶∞‡ßç‡¶§‡¶Æ‡¶æ‡¶® setup ‡¶è Minimum ‡¶ï‡ßÄ ‡¶ï‡¶∞‡¶æ ‡¶â‡¶ö‡¶ø‡¶§?

	‡¶Ø‡¶¶‡¶ø ‡¶õ‡ßã‡¶ü production ‡¶π‡ßü:

	‚úî /u01/rman_backup ‡¶Ü‡¶≤‡¶æ‡¶¶‡¶æ mount ‡¶π‡¶ì‡ßü‡¶æ ‡¶â‡¶ö‡¶ø‡¶§
	‚úî ‡¶∏‡¶™‡ßç‡¶§‡¶æ‡¶π‡ßá ‡ßß‡¶¨‡¶æ‡¶∞ ‡¶Ö‡¶®‡ßç‡¶Ø server ‡¶è rsync ‡¶ï‡¶∞‡ßã
	‚úî Monthly restore test ‡¶ï‡¶∞‡ßã

	‚ö†Ô∏è ‡¶∏‡¶¨‡¶ö‡ßá‡ßü‡ßá ‡¶¨‡ßú ‡¶≠‡ßÅ‡¶≤ DBA‡¶∞‡¶æ ‡¶ï‡¶∞‡ßá

	Backup ‡¶®‡ßá‡ßü
	‡¶ï‡¶ø‡¶®‡ßç‡¶§‡ßÅ restore test ‡¶ï‡¶∞‡ßá ‡¶®‡¶æ ‚ùå

	Backup = Valid only if restore works.
	
	



=============================================================  Intrview  ============================================================= 
	
	
	üî• ‡¶™‡ßÅ‡¶∞‡ßã flow diagram
		Archive Logs (.arc files)
				‚Üì
		RMAN BACKUP command
				‚Üì
		Backup Set (Logical Group)
				‚Üì
		Backup Piece (.bkp physical file)
				‚Üì
		Stored in Disk (/u01/rman_backup/)

	‚ùì Q1: What is the difference between Backup Set and Backup Piece?
	‚úÖ Answer:

	Backup Set is a logical grouping of files backed up by RMAN.
	Backup Piece is the physical file written to disk or tape containing the backup set data.

	‚ùì Q2: Can one backup piece contain multiple archive logs?
	‚úÖ Answer:

	Yes. By default RMAN groups multiple archive logs into a single backup set, which is written as one or more backup pieces.

	‚ùì Q3: How do you make one archive log per backup piece?
	‚úÖ Answer:

	Use:

	BACKUP ARCHIVELOG ALL FILESPERSET 1;


	This forces RMAN to create one backup set per archived log.

	‚ùì Q4: How do you check which archive logs are inside a backup piece?
	‚úÖ Answer:
	LIST BACKUP OF ARCHIVELOG ALL;


	or

	LIST BACKUPSET <key>;

	‚ùì Q5: Where does RMAN store backup metadata?
	‚úÖ Answer:

	Control file (default)

	Or Recovery Catalog (optional centralized repository)

	‚ùì Q6: What happens during RESTORE ARCHIVELOG?
	‚úÖ Answer:

	RMAN reads the backup piece ‚Üí extracts the backup set ‚Üí recreates the original archive log files.

	‚ùì Q7: In Data Guard, what happens if archive log is missing?
	‚úÖ Answer:

	Standby apply will stop with gap error.
	We must restore the missing archive log or perform incremental roll forward.

	üéØ Interview Gold Line (Must Say)

	"Backup set is a logical structure maintained by RMAN, whereas backup piece is the actual physical file stored on disk or tape."





=============================================================  Lab Practice  ============================================================= 


*** first enable archive log mode
	archive log list
	shutdown immediate
	startup mount
	alter database archivelog;
	archive log list;[enabled]
	
*** rman backup jekhane hobe sei location create korbo
	su - root
	mkdir -p /u01/backup
	chown -R oracle:oinstall /u01/backup
	chmod 775 /u01/backup
	
	ALTER SYSTEM SET DB_RECOVERY_FILE_DEST = '/u01/rman_backup/';
	
*** now get rman backup
	su - oracle
	rman target /
	backup databse plus archivelog; [ full database backup hobe]
	backup current controlfile format '/u01/app/oracle/fast_recovery_area/ALAMIN/backupset/2025_01_11/ControlFile_%d_%u_%s';
	
	sqlplus / as sysdba
	create pfile='/u01/backup/LIVEDB/backupset/2024_12_24/pfile.ora' from spfile;
	select GROUP#,THREAD#,SEQUENCE#,STATUS FROM V$LOG;
	

*** Now amra last porjonto archive log gulo backup nibo restore korer jonne
	--ARCHIVELOG BACKUP..
backup format '/u01/rman_bkp//arc_%d_%s_%p_%c_%t.arc.bkp' 
archivelog from sequence 6 until sequence 14;




‡ß®Ô∏è.  ‡¶∏‡¶†‡¶ø‡¶ï RMAN ARCHIVELOG backup command=======================================================================================
rman target /

RUN {
  BACKUP AS BACKUPSET
    FORMAT '/u01/rman_bkp/arc_%d_%s_%p_%c_%t.arc.bkp'
    ARCHIVELOG FROM SEQUENCE 9 UNTIL SEQUENCE 18;
}

‡¶¨‡ßç‡¶Ø‡¶æ‡¶ñ‡ßç‡¶Ø‡¶æ:
‡¶Ö‡¶Ç‡¶∂	‡¶Ö‡¶∞‡ßç‡¶•
rman target /	local database connect (SYSDBA privilege)
RUN { ... }	multiple commands ‡¶è‡¶ï‡¶∏‡¶æ‡¶•‡ßá ‡¶ö‡¶æ‡¶≤‡¶æ‡¶®‡ßã‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø
BACKUP AS BACKUPSET	backupset mode, recommended
FORMAT '/u01/backup/%d_%s_%p_%c_%t.arc.bkp'	backup file naming convention
%d	database name
%s	backup set number
%p	backup piece number
%c	backup piece change number
%t	timestamp
ARCHIVELOG FROM SEQUENCE 6 UNTIL SEQUENCE 14	sequence 6‚Äì14 ‡¶™‡¶∞‡ßç‡¶Ø‡¶®‡ßç‡¶§ archive log backup ‡¶®‡ßá‡¶¨‡ßá====================================



	
	
*** ami asm theke ei 4 ti backup nilam 
	i)pfile
	ii)full rman backup
	iii)current controlfile
	iv)archivelog backup from last sequence
	
*** ei 4 ti backup er file gula new server ay software only diye sei server ay scp kore nite hobe.
	--i) create new server and setup software only
	--ii) scp all backup 
	--iii) using pfile we need to nomount this database
	--iv) when database nomount then we get connection Rman
	--v) now we restore controlfile so we connect with mount mode 
	--vi) now run restore & recover script;
	
*** now scp
	scp LIVEDB_9_1_1_1188538300.arc.bkp root@10.55.66.44:/u01/backup
	cd /u01/backup/LIVEDB/backupset/2024_12_24
	scp * root@10.55.66.44:/u01/backup
	
	su - root
	cd /u01/backup
	chown -R oracle:oinstall ControlFile_LIVEDB_053df6eg_5 LIVEDB_9_1_1_1188538300.arc.bkp o1_mf_annnn_TAG20241224T042729_mpnzn27d_.bkp o1_mf_annnn_TAG20241224T042739_mpnzncjy_.bkp o1_mf_nnndf_TAG20241224T042731_mpnzn3xk_.bkp pfile.ora;
	chmod 775 ControlFile_LIVEDB_053df6eg_5 LIVEDB_9_1_1_1188538300.arc.bkp o1_mf_annnn_TAG20241224T042729_mpnzn27d_.bkp o1_mf_annnn_TAG20241224T042739_mpnzncjy_.bkp o1_mf_nnndf_TAG20241224T042731_mpnzn3xk_.bkp pfile.ora;
	
	
	vi pfile.ora and modify this pfile;
	
	su - oracle
	sqlplus /nolog
	conn sys as sysdba
	startup nomount pfile='/u01/backup/pfile.ora';
	create spfile from pfile='/u01/backup/pfile.ora';
	create pfile from spfile;
	shutdown immediate
	startup nomount;
	exit;
	
	rman target /
	
	restore controlfile from '/u01/backup/Contolfile_location';
	
	su - oracle
	tail -f alert log open korbo.
	
	sql@ alter database mount;
	
	catalog start with '/u01/backup';
	
		
		#restore and recover script:

		run {
		# allocate a channel to the tape device
		ALLOCATE CHANNEL d1 DEVICE TYPE disk;
		ALLOCATE CHANNEL d2 DEVICE TYPE disk;
		# rename the datafiles and online redo logs
		SET NEWNAME FOR DATABASE TO '/u01/data_store/LIVEDB/%b'; 
		SET NEWNAME FOR tempfile 1 TO '/u01/data_store/LIVEDB/%b';
		SQL "ALTER DATABASE RENAME FILE ''+DATA/LIVEDB/ONLINELOG/group_3.263.1190695025''
		to ''/u01/data_store/LIVEDB/group_2.261.1011700477''" ;
		SQL "ALTER DATABASE RENAME FILE ''+DATA/LIVEDB/ONLINELOG/group_2.264.1190695025''
		to ''/u01/data_store/LIVEDB/group_2.262.1011700477''" ;
		SQL "ALTER DATABASE RENAME FILE ''+DATA/LIVEDB/ONLINELOG/group_1.262.1190695025''
		to ''/u01/data_store/LIVEDB/group_2.263.1011700477''" ;

		SET ARCHIVELOG DESTINATION TO '/u01/backup/';
		# Do a SET UNTIL to prevent recovery of the online logs
		SET UNTIL SEQUENCE 14;
		# restore the database and switch the datafile names
		restore database;
		switch datafile all;
		switch tempfile all;
		RECOVER DATABASE;
		RELEASE CHANNEL d1;
		RELEASE CHANNEL d2;
		}
		
		
	-------------- if any issue then
	
	====== Error ==== 1. RMAN-06054: media recovery requesting unknown archived log for thread 1 with sequence 26 and starting SCN of 3002344
	====== Error Description ======== RMAN Restore Error - media recovery requesting unknown log: thread 1 seq 7
	====== Error Description ======== It has applied all the available archives, whenever you give recover database, it keeps search for the next archives, actually those archives are not yet generated, so you can ignore.
	===== Solve ===== run { restore database; recover database; alter database open resetlogs; }

	-----------------------------------
	
	
*************************************************************************************************************************************
*************************************************************************************************************************************
===================================== rman asm to file system success restore, recover all command ====================================
[oracle@testserver ~]$ rman target /

Recovery Manager: Release 19.0.0.0.0 - Production on Mon Jan 6 04:41:00 2025
Version 19.3.0.0.0

Copyright (c) 1982, 2019, Oracle and/or its affiliates.  All rights reserved.

connected to target database: LIVEDB (not mounted)

RMAN> restore controlfile from '/u01/backup/ControlFile_LIVEDB_053ehda4_5';

Starting restore at 06/01/2025:04:43:23
using target database control file instead of recovery catalog
allocated channel: ORA_DISK_1
channel ORA_DISK_1: SID=39 device type=DISK

channel ORA_DISK_1: restoring control file
channel ORA_DISK_1: restore complete, elapsed time: 00:00:01
output file name=/u01/data_store/LIVEDB/controlfile/o1_mf_mqq9fvkx_.ctl
output file name=/u01/fra/LIVEDB/controlfile/o1_mf_mqq9fvlw_.ctl
Finished restore at 06/01/2025:04:43:24

RMAN> exit


Recovery Manager complete.
[oracle@testserver ~]$ rman target /

Recovery Manager: Release 19.0.0.0.0 - Production on Mon Jan 6 04:44:19 2025
Version 19.3.0.0.0

Copyright (c) 1982, 2019, Oracle and/or its affiliates.  All rights reserved.

connected to target database: LIVEDB (DBID=3145359635, not open)

RMAN> exit


Recovery Manager complete.
c[oracle@testserver ~]$ clear
[oracle@testserver ~]$ rman target /

Recovery Manager: Release 19.0.0.0.0 - Production on Mon Jan 6 04:44:27 2025
Version 19.3.0.0.0

Copyright (c) 1982, 2019, Oracle and/or its affiliates.  All rights reserved.

connected to target database: LIVEDB (DBID=3145359635, not open)

RMAN> catalog start with '/u01/backup';

Starting implicit crosscheck backup at 06/01/2025:04:47:17
using target database control file instead of recovery catalog
allocated channel: ORA_DISK_1
channel ORA_DISK_1: SID=33 device type=DISK
Crosschecked 4 objects
Finished implicit crosscheck backup at 06/01/2025:04:47:18

Starting implicit crosscheck copy at 06/01/2025:04:47:18
using channel ORA_DISK_1
Finished implicit crosscheck copy at 06/01/2025:04:47:18

searching for all files in the recovery area
cataloging files...
no files cataloged

searching for all files that match the pattern /u01/backup

List of Files Unknown to the Database
=====================================
File Name: /u01/backup/ControlFile_LIVEDB_053ehda4_5
File Name: /u01/backup/o1_mf_annnn_TAG20250106T035619_mqq6omb8_.bkp
File Name: /u01/backup/o1_mf_annnn_TAG20250106T035627_mqq6ow25_.bkp
File Name: /u01/backup/o1_mf_nnndf_TAG20250106T035620_mqq6onno_.bkp
File Name: /u01/backup/pfile.ora

Do you really want to catalog the above files (enter YES or NO)? YES
cataloging files...
cataloging done

List of Cataloged Files
=======================
File Name: /u01/backup/ControlFile_LIVEDB_053ehda4_5
File Name: /u01/backup/o1_mf_annnn_TAG20250106T035619_mqq6omb8_.bkp
File Name: /u01/backup/o1_mf_annnn_TAG20250106T035627_mqq6ow25_.bkp
File Name: /u01/backup/o1_mf_nnndf_TAG20250106T035620_mqq6onno_.bkp

List of Files Which Were Not Cataloged
=======================================
File Name: /u01/backup/pfile.ora
  RMAN-07517: Reason: The file header is corrupted

RMAN>

RMAN>

RMAN> run {
# allocate a channel to the tape device
ALLOCATE CHANNEL d1 DEVICE TYPE disk;
ALLOCATE CHANNEL d2 DEVICE TYPE disk;
2> 3> 4> 5> # rename the datafiles and online redo logs
SET NEWNAME FOR DATABASE TO '/u01/data_store/LIVEDB/%b';
SET NEWNAME FOR tempfile 1 TO '/u01/data_store/LIVEDB/%b';
SQL "ALTER DATABASE RENAME FILE ''+DATA/LIVEDB/ONLINELOG/group_3.264.1189647001''
to ''/u01/data_store/LIVEDB/group_2.261.1011700477''" ;
SQL "ALTER DATABASE RENAME FILE ''+DATA/LIVEDB/ONLINELOG/group_2.263.1189646999''
to ''/u01/data_store/LIVEDB/group_2.262.1011700477''" ;
SQL "ALTER DATABASE RENAME FILE ''+DATA/LIVEDB/ONLINELOG/group_1.262.1189646999''
to ''/u01/data_store/LIVEDB/group_2.263.1011700477''" ;
restore database;
switch datafile all;
switch tempfile all;
RECOVER DATABASE;
RELEASE CHANNEL d1;
RELEASE CHANNEL d2;
}6> 7> 8> 9> 10> 11> 12> 13> 14> 15> 16> 17> 18> 19> 20>

released channel: ORA_DISK_1
allocated channel: d1
channel d1: SID=33 device type=DISK

allocated channel: d2
channel d2: SID=35 device type=DISK

executing command: SET NEWNAME

executing command: SET NEWNAME

sql statement: ALTER DATABASE RENAME FILE ''+DATA/LIVEDB/ONLINELOG/group_3.264.118964                                                                                                7001''to ''/u01/data_store/LIVEDB/group_2.261.1011700477''

sql statement: ALTER DATABASE RENAME FILE ''+DATA/LIVEDB/ONLINELOG/group_2.263.118964                                                                                                6999''to ''/u01/data_store/LIVEDB/group_2.262.1011700477''

sql statement: ALTER DATABASE RENAME FILE ''+DATA/LIVEDB/ONLINELOG/group_1.262.118964                                                                                                6999''to ''/u01/data_store/LIVEDB/group_2.263.1011700477''

Starting restore at 06/01/2025:04:55:33

channel d1: starting datafile backup set restore
channel d1: specifying datafile(s) to restore from backup set
channel d1: restoring datafile 00001 to /u01/data_store/LIVEDB/system.257.1189646887
channel d1: restoring datafile 00003 to /u01/data_store/LIVEDB/sysaux.258.1189646923
channel d1: restoring datafile 00004 to /u01/data_store/LIVEDB/undotbs1.259.118964693                                                                                                7
channel d1: restoring datafile 00005 to /u01/data_store/LIVEDB/alamin.267.1189648685
channel d1: restoring datafile 00007 to /u01/data_store/LIVEDB/users.260.1189646939
channel d1: reading from backup piece /u01/backup/o1_mf_nnndf_TAG20250106T035620_mqq6                                                                                                onno_.bkp
channel d1: piece handle=/u01/backup/o1_mf_nnndf_TAG20250106T035620_mqq6onno_.bkp tag                                                                                                =TAG20250106T035620
channel d1: restored backup piece 1
channel d1: restore complete, elapsed time: 00:00:07
Finished restore at 06/01/2025:04:55:40

datafile 1 switched to datafile copy
input datafile copy RECID=6 STAMP=1189659340 file name=/u01/data_store/LIVEDB/system.                                                                                                257.1189646887
datafile 3 switched to datafile copy
input datafile copy RECID=7 STAMP=1189659340 file name=/u01/data_store/LIVEDB/sysaux.                                                                                                258.1189646923
datafile 4 switched to datafile copy
input datafile copy RECID=8 STAMP=1189659340 file name=/u01/data_store/LIVEDB/undotbs                                                                                                1.259.1189646937
datafile 5 switched to datafile copy
input datafile copy RECID=9 STAMP=1189659340 file name=/u01/data_store/LIVEDB/alamin.                                                                                                267.1189648685
datafile 7 switched to datafile copy
input datafile copy RECID=10 STAMP=1189659340 file name=/u01/data_store/LIVEDB/users.                                                                                                260.1189646939

renamed tempfile 1 to /u01/data_store/LIVEDB/temp.265.1189647007 in control file

Starting recover at 06/01/2025:04:55:40

starting media recovery

channel d1: starting archived log restore to default destination
channel d1: restoring archived log
archived log thread=1 sequence=7
channel d1: reading from backup piece /u01/backup/o1_mf_annnn_TAG20250106T035627_mqq6                                                                                                ow25_.bkp
channel d1: piece handle=/u01/backup/o1_mf_annnn_TAG20250106T035627_mqq6ow25_.bkp tag                                                                                                =TAG20250106T035627
channel d1: restored backup piece 1
channel d1: restore complete, elapsed time: 00:00:01
archived log file name=/u01/fra/LIVEDB/archivelog/2025_01_06/o1_mf_1_7_mqqb4x29_.arc                                                                                                 thread=1 sequence=7
channel default: deleting archived log(s)
archived log file name=/u01/fra/LIVEDB/archivelog/2025_01_06/o1_mf_1_7_mqqb4x29_.arc                                                                                                 RECID=4 STAMP=1189659341
unable to find archived log
archived log thread=1 sequence=8
released channel: d1
released channel: d2
RMAN-00571: ===========================================================
RMAN-00569: =============== ERROR MESSAGE STACK FOLLOWS ===============
RMAN-00571: ===========================================================
RMAN-03002: failure of recover command at 01/06/2025 04:55:42
RMAN-06054: media recovery requesting unknown archived log for thread 1 with sequence                                                                                                 8 and starting SCN of 2046808

RMAN> run { restore database; recover database; alter database open resetlogs; }

Starting restore at 06/01/2025:04:59:10
allocated channel: ORA_DISK_1
channel ORA_DISK_1: SID=33 device type=DISK

channel ORA_DISK_1: starting datafile backup set restore
channel ORA_DISK_1: specifying datafile(s) to restore from backup set
channel ORA_DISK_1: restoring datafile 00001 to /u01/data_store/LIVEDB/system.257.118                                                                                                9646887
channel ORA_DISK_1: restoring datafile 00003 to /u01/data_store/LIVEDB/sysaux.258.118                                                                                                9646923
channel ORA_DISK_1: restoring datafile 00004 to /u01/data_store/LIVEDB/undotbs1.259.1                                                                                                189646937
channel ORA_DISK_1: restoring datafile 00005 to /u01/data_store/LIVEDB/alamin.267.118                                                                                                9648685
channel ORA_DISK_1: restoring datafile 00007 to /u01/data_store/LIVEDB/users.260.1189                                                                                                646939
channel ORA_DISK_1: reading from backup piece /u01/backup/o1_mf_nnndf_TAG20250106T035                                                                                                620_mqq6onno_.bkp
channel ORA_DISK_1: piece handle=/u01/backup/o1_mf_nnndf_TAG20250106T035620_mqq6onno_                                                                                                .bkp tag=TAG20250106T035620
channel ORA_DISK_1: restored backup piece 1
channel ORA_DISK_1: restore complete, elapsed time: 00:00:07
Finished restore at 06/01/2025:04:59:17

Starting recover at 06/01/2025:04:59:17
using channel ORA_DISK_1

starting media recovery

channel ORA_DISK_1: starting archived log restore to default destination
channel ORA_DISK_1: restoring archived log
archived log thread=1 sequence=7
channel ORA_DISK_1: reading from backup piece /u01/backup/o1_mf_annnn_TAG20250106T035                                                                                                627_mqq6ow25_.bkp
channel ORA_DISK_1: piece handle=/u01/backup/o1_mf_annnn_TAG20250106T035627_mqq6ow25_                                                                                                .bkp tag=TAG20250106T035627
channel ORA_DISK_1: restored backup piece 1
channel ORA_DISK_1: restore complete, elapsed time: 00:00:01
archived log file name=/u01/fra/LIVEDB/archivelog/2025_01_06/o1_mf_1_7_mqqbcobz_.arc                                                                                                 thread=1 sequence=7
channel default: deleting archived log(s)
archived log file name=/u01/fra/LIVEDB/archivelog/2025_01_06/o1_mf_1_7_mqqbcobz_.arc                                                                                                 RECID=5 STAMP=1189659557
unable to find archived log
archived log thread=1 sequence=8
RMAN-00571: ===========================================================
RMAN-00569: =============== ERROR MESSAGE STACK FOLLOWS ===============
RMAN-00571: ===========================================================
RMAN-03002: failure of recover command at 01/06/2025 04:59:18
RMAN-06054: media recovery requesting unknown archived log for thread 1 with sequence                                                                                                 8 and starting SCN of 2046808

*****************************************************************************************************************************************
*****************************************************************************************************************************************
*****************************************************************************************************************************************



=======================================================================================================================================
================================================== Shel Scripting =====================================================================

1) cd /etc/cron.daily

2)  mkdir rman.sh
	chmod +x rman.sh 
	chown -R oracle:oinstall rman.sh
	chmod 775 rman.sh
	
3) vi rman.sh
	
	#!/bin/bash
	date=$(date +"%y_%m_%d_%H:%M")
	echo "Backup is starting $date"

	export ORACLE_HOME=/u01/app/oracle/product/19.0.0.0/dbhome_1
	export ORACLE_SID=KNIT_HRMS
	export PATH=$ORACLE_HOME/bin:$PATH

	BACKUP_DIR=/u01/rman_backup
	LOG_FILE=$BACKUP_DIR/rman_$(date +%Y%m%d_%H%M).log

	$ORACLE_HOME/bin/rman target sys/sys123@KNIT_HRMS  <<EOF >> $LOG_FILE 2>&1

	RUN {
		ALLOCATE CHANNEL ch1 DEVICE TYPE DISK;

		BACKUP INCREMENTAL LEVEL 0 DATABASE
		FORMAT '/u01/rman_backup/L0_db_%d_%T_%U.bkp';

		BACKUP ARCHIVELOG ALL
		FORMAT '/u01/rman_backup/L0_arch_%d_%T_%U.bkp'
		DELETE INPUT;

		RELEASE CHANNEL ch1;
	}

	EXIT;
	EOF
	echo "Backup is end"


		
4) crontab -e
	38 11 * * * /etc/cron.daily/rman.sh [crontab -e er vitore ei time ta bole dilam]

	*  *  *  *  *  command
	|  |  |  |  |
	|  |  |  |  ‚îî‚îÄ‚îÄ ‡¶∏‡¶™‡ßç‡¶§‡¶æ‡¶π‡ßá‡¶∞ ‡¶¶‡¶ø‡¶® (0-7)
	|  |  |  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ ‡¶Æ‡¶æ‡¶∏ (1-12)
	|  |  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ ‡¶Æ‡¶æ‡¶∏‡ßá‡¶∞ ‡¶¶‡¶ø‡¶® (1-31)
	|  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ ‡¶ò‡¶®‡ßç‡¶ü‡¶æ (0-23)
	‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ ‡¶Æ‡¶ø‡¶®‡¶ø‡¶ü (0-59)
	
	
5) systemctl restart crond.service


6) tail -f /var/log/cron [log dekhabe]



======================================= level 0 backup =============================================================

‚úÖ üîµ Level 0 Backup (Full Backup) ‚Äì Separate FORMAT ‡¶∏‡¶π

RUN {
    ALLOCATE CHANNEL ch1 DEVICE TYPE DISK;

    BACKUP INCREMENTAL LEVEL 0 DATABASE
    FORMAT '/u01/rman_backup/L0_db_%d_%T_%U.bkp';

    BACKUP ARCHIVELOG ALL
    FORMAT '/u01/rman_backup/L0_arch_%d_%T_%U.bkp'
    DELETE INPUT;

    RELEASE CHANNEL ch1;
}


‡¶è‡¶ñ‡¶® file name ‡¶π‡¶¨‡ßá ‡¶è‡¶∞‡¶ï‡¶Æ:

L0_db_KNIT_HRMS_20260215_xxxxx.bkp
L0_arch_KNIT_HRMS_20260215_xxxxx.bkp


=========================================================================================================================


‚úÖ üü¢ Level 1 Backup (Incremental Backup)

RUN {
    ALLOCATE CHANNEL ch1 DEVICE TYPE DISK;

    BACKUP INCREMENTAL LEVEL 1 DATABASE
    FORMAT '/u01/rman_backup/L1_db_%d_%T_%U.bkp';

    BACKUP ARCHIVELOG ALL
    FORMAT '/u01/rman_backup/L1_arch_%d_%T_%U.bkp'
    DELETE INPUT;

    RELEASE CHANNEL ch1;
}

‡¶è‡¶ñ‡¶® file ‡¶π‡¶¨‡ßá:

L1_db_KNIT_HRMS_20260216_xxxxx.bkp
L1_arch_KNIT_HRMS_20260216_xxxxx.bkp



==============================================  Crontab Backup Automation  ===========================================

	Sunday        ‚Üí Level 0 (Full)
	Mon‚ÄìSat       ‚Üí Level 1 (Incremental)
	Every 1‚Äì2 hr  ‚Üí Archivelog


	‡¶∏‡¶¨ cronjob ‡¶¶‡¶ø‡ßü‡ßá automate ‡¶ï‡¶∞‡¶¨‡ßã‡•§

	‚úÖ Step-1: RMAN Script ‡¶§‡ßà‡¶∞‡¶ø ‡¶ï‡¶∞‡¶æ

	‡¶Ü‡¶Æ‡¶∞‡¶æ ‡ß©‡¶ü‡¶æ ‡¶Ü‡¶≤‡¶æ‡¶¶‡¶æ script ‡¶¨‡¶æ‡¶®‡¶æ‡¶¨‡ßã‡•§

	üîπ 1Ô∏è. Level 0 Script (Sunday Full Backup)

	üìÅ File: /u01/rman_scripts/level0.sh

#!/bin/bash

export ORACLE_HOME=/u01/app/oracle/product/19.0.0.0/dbhome_1
export ORACLE_SID=KNIT_HRMS
export PATH=$ORACLE_HOME/bin:$PATH

rman target sys/sys123@KNIT_HRMS <<EOF

RUN {
  BACKUP INCREMENTAL LEVEL 0 DATABASE
	FORMAT '/u01/rman_backup/L0/L0_%d_%T_%U.bkp'
	TAG 'WEEKLY_L0';

  BACKUP ARCHIVELOG ALL
	FORMAT '/u01/rman_backup/ARCH/arch_%d_%T_%U.bkp'
	NOT BACKED UP 1 TIMES;

  BACKUP CURRENT CONTROLFILE
	FORMAT '/u01/rman_backup/CONTROL/control_%d_%T_%U.bkp';
}

EOF

========================================================================= What is TAG 

	üîé TAG ‡¶ï‡ßÄ?

		TAG ‡¶π‡¶ö‡ßç‡¶õ‡ßá RMAN backup-‡¶è‡¶∞ ‡¶è‡¶ï‡¶ü‡¶ø logical label ‡¶¨‡¶æ identifier, ‡¶Ø‡ßá‡¶ü‡¶æ ‡¶¶‡¶ø‡ßü‡ßá ‡¶™‡¶∞‡ßá ‡¶∏‡¶π‡¶ú‡ßá ‡¶∏‡ßá‡¶á backup-‡¶ü‡¶æ‡¶ï‡ßá ‡¶ö‡¶ø‡¶®‡¶§‡ßá, ‡¶ñ‡ßÅ‡¶Å‡¶ú‡¶§‡ßá ‡¶¨‡¶æ restore ‡¶ï‡¶∞‡¶§‡ßá ‡¶™‡¶æ‡¶∞‡¶¨‡ßá‡•§

		‡¶è‡¶ü‡¶æ physical file name ‡¶®‡¶æ ‚Äî ‡¶è‡¶ü‡¶æ RMAN catalog/control file-‡¶è metadata ‡¶π‡¶ø‡¶∏‡ßá‡¶¨‡ßá ‡¶∏‡¶Ç‡¶∞‡¶ï‡ßç‡¶∑‡¶ø‡¶§ ‡¶•‡¶æ‡¶ï‡ßá‡•§

	üìå ‡¶ï‡ßá‡¶® TAG ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞ ‡¶ï‡¶∞‡¶æ ‡¶π‡ßü?

		‡¶ß‡¶∞‡ßã:

		‡¶™‡ßç‡¶∞‡¶§‡¶ø ‡¶∏‡¶™‡ßç‡¶§‡¶æ‡¶π‡ßá ‡¶§‡ßÅ‡¶Æ‡¶ø Level 0 backup ‡¶®‡¶ø‡¶ö‡ßç‡¶õ‡ßã

		‡¶™‡ßç‡¶∞‡¶§‡¶ø‡¶¶‡¶ø‡¶® Level 1 backup ‡¶®‡¶ø‡¶ö‡ßç‡¶õ‡ßã

		‡¶§‡¶æ‡¶π‡¶≤‡ßá ‡¶§‡ßÅ‡¶Æ‡¶ø ‡¶è‡¶≠‡¶æ‡¶¨‡ßá tag ‡¶¶‡¶ø‡¶§‡ßá ‡¶™‡¶æ‡¶∞‡ßã:

		TAG 'WEEKLY_L0'
		TAG 'DAILY_L1'


		‡¶è‡¶§‡ßá ‡¶™‡¶∞‡ßá ‡¶ñ‡ßÅ‡¶¨ ‡¶∏‡¶π‡¶ú‡ßá ‡¶¨‡¶≤‡¶§‡ßá ‡¶™‡¶æ‡¶∞‡¶¨‡ßá:

		RESTORE DATABASE FROM TAG 'WEEKLY_L0';


		‡¶Ö‡¶•‡¶¨‡¶æ

		LIST BACKUP TAG 'WEEKLY_L0';

=========================================================================


	üîπ 2Ô∏è. Level 1 Script (Mon‚ÄìSat)

	üìÅ File: /u01/rman_scripts/level1.sh

#!/bin/bash

export ORACLE_HOME=/u01/app/oracle/product/19.0.0.0/dbhome_1
export ORACLE_SID=KNIT_HRMS
export PATH=$ORACLE_HOME/bin:$PATH

rman target sys/sys123@KNIT_HRMS <<EOF

RUN {
        BACKUP INCREMENTAL LEVEL 1 DATABASE
        FORMAT '/u01/rman_backup/L1/L1_%d_%T_%U.bkp'
        TAG 'DAILY_L1';

        BACKUP ARCHIVELOG ALL
        FORMAT '/u01/rman_backup/ARCH/arch_%d_%T_%U.bkp'
        NOT BACKED UP 1 TIMES;

        BACKUP CURRENT CONTROLFILE
        FORMAT '/u01/rman_backup/CONTROL/control_%d_%T_%U.bkp';
}

EOF



	üîπ 3Ô∏è. Archivelog Script (Every 1 Hour)

	üìÅ File: /u01/rman_scripts/arch.sh

#!/bin/bash

export ORACLE_HOME=/u01/app/oracle/product/19.0.0.0/dbhome_1
export ORACLE_SID=KNIT_HRMS
export PATH=$ORACLE_HOME/bin:$PATH

rman target sys/sys123@KNIT_HRMS <<EOF

RUN {

        BACKUP ARCHIVELOG ALL
        FORMAT '/u01/rman_backup/ARCH/arch_%d_%T_%U.bkp'
        NOT BACKED UP 1 TIMES;

}

EOF
	
	
	==============================================================================================================================

	‡¶∏‡¶¨ script executable ‡¶ï‡¶∞‡ßã:
	chmod +x /u01/rman_scripts/*.sh

	‚úÖ Step-2: Cronjob Setup
	
	su - oracle
	
	crontab -e

	# Sunday Level 0 ‚Äì 2:00 AM
	0 2 * * 0 /u01/rman_scripts/level0.sh >> /u01/rman_scripts/scripts_log/L0_backup.log

	# Mon‚ÄìSat Level 1 ‚Äì 2:00 AM
	0 2 * * 1-6 /u01/rman_scripts/level1.sh >> /u01/rman_scripts/scripts_log/L1_backup.log

	# Every 1 hour Archivelog
	0 * * * * /u01/rman_scripts/arch.sh >> /u01/rman_scripts/scripts_log/Daily_arch.log
	
	# Jodi ajke crontab chalate chai
	28 11 * * * /u01/rman_scripts/level0.sh >> /u01/rman_scripts/scripts_log/L0_backup.log

	üî• Production Important Configuration

	‡¶è‡¶ï‡¶¨‡¶æ‡¶∞ configure ‡¶ï‡¶∞‡ßá ‡¶∞‡¶æ‡¶ñ‡¶¨‡ßá:

	CONFIGURE CONTROLFILE AUTOBACKUP ON;
	CONFIGURE BACKUP OPTIMIZATION ON;
	CONFIGURE RETENTION POLICY TO RECOVERY WINDOW OF 7 DAYS;

	üéØ Interview Question ‡¶Ü‡¶∏‡¶§‡ßá ‡¶™‡¶æ‡¶∞‡ßá

	‚ùì Why Level 0 on Sunday?

	üëâ Because it acts as base for incremental backups.

	‚ùì Why frequent archivelog backup?

	üëâ To minimize data loss window and reduce FRA usage.

	‚ùì Why NOT BACKED UP 1 TIMES?

	üëâ To prevent duplicate archivelog backups.



========================== Change Time Zone   ========================================================================

date

timedatectl

sudo timedatectl set-ntp true

systemctl status chronyd
‡¶Ø‡¶¶‡¶ø inactive ‡¶•‡¶æ‡¶ï‡ßá:
sudo systemctl start chronyd
sudo systemctl enable chronyd

sudo chronyc makestep


[ VM ay time zone change kore bangladesh korbo ]

